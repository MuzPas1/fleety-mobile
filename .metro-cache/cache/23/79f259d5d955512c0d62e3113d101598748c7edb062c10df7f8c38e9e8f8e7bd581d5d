{"dependencies":[{"name":"@babel/runtime/helpers/classCallCheck","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":228,"column":44,"index":8339}}],"key":"ohGilxjVqjyE1GooDVDt9OYg9x0="}},{"name":"@babel/runtime/helpers/createClass","data":{"asyncType":null,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":228,"column":44,"index":8339}}],"key":"V6GYoXnblvuuGHJNMy7MHyaunsU="}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  /*\n    This file draws heavily from https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/assets/js/phoenix/presence.js\n    License: https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/LICENSE.md\n  */\n  var _classCallCheck = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/classCallCheck\");\n  var _createClass = _$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/createClass\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.REALTIME_PRESENCE_LISTEN_EVENTS = void 0;\n  var REALTIME_PRESENCE_LISTEN_EVENTS;\n  (function (REALTIME_PRESENCE_LISTEN_EVENTS) {\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"SYNC\"] = \"sync\";\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"JOIN\"] = \"join\";\n    REALTIME_PRESENCE_LISTEN_EVENTS[\"LEAVE\"] = \"leave\";\n  })(REALTIME_PRESENCE_LISTEN_EVENTS = exports.REALTIME_PRESENCE_LISTEN_EVENTS || (exports.REALTIME_PRESENCE_LISTEN_EVENTS = {}));\n  var RealtimePresence = /*#__PURE__*/function () {\n    /**\n     * Initializes the Presence.\n     *\n     * @param channel - The RealtimeChannel\n     * @param opts - The options,\n     *        for example `{events: {state: 'state', diff: 'diff'}}`\n     */\n    function RealtimePresence(channel, opts) {\n      var _this = this;\n      _classCallCheck(this, RealtimePresence);\n      this.channel = channel;\n      this.state = {};\n      this.pendingDiffs = [];\n      this.joinRef = null;\n      this.caller = {\n        onJoin: function () {},\n        onLeave: function () {},\n        onSync: function () {}\n      };\n      var events = (opts === null || opts === void 0 ? void 0 : opts.events) || {\n        state: 'presence_state',\n        diff: 'presence_diff'\n      };\n      this.channel._on(events.state, {}, function (newState) {\n        var _this$caller = _this.caller,\n          onJoin = _this$caller.onJoin,\n          onLeave = _this$caller.onLeave,\n          onSync = _this$caller.onSync;\n        _this.joinRef = _this.channel._joinRef();\n        _this.state = RealtimePresence.syncState(_this.state, newState, onJoin, onLeave);\n        _this.pendingDiffs.forEach(function (diff) {\n          _this.state = RealtimePresence.syncDiff(_this.state, diff, onJoin, onLeave);\n        });\n        _this.pendingDiffs = [];\n        onSync();\n      });\n      this.channel._on(events.diff, {}, function (diff) {\n        var _this$caller2 = _this.caller,\n          onJoin = _this$caller2.onJoin,\n          onLeave = _this$caller2.onLeave,\n          onSync = _this$caller2.onSync;\n        if (_this.inPendingSyncState()) {\n          _this.pendingDiffs.push(diff);\n        } else {\n          _this.state = RealtimePresence.syncDiff(_this.state, diff, onJoin, onLeave);\n          onSync();\n        }\n      });\n      this.onJoin(function (key, currentPresences, newPresences) {\n        _this.channel._trigger('presence', {\n          event: 'join',\n          key,\n          currentPresences,\n          newPresences\n        });\n      });\n      this.onLeave(function (key, currentPresences, leftPresences) {\n        _this.channel._trigger('presence', {\n          event: 'leave',\n          key,\n          currentPresences,\n          leftPresences\n        });\n      });\n      this.onSync(function () {\n        _this.channel._trigger('presence', {\n          event: 'sync'\n        });\n      });\n    }\n    /**\n     * Used to sync the list of presences on the server with the\n     * client's state.\n     *\n     * An optional `onJoin` and `onLeave` callback can be provided to\n     * react to changes in the client's local presences across\n     * disconnects and reconnects with the server.\n     *\n     * @internal\n     */\n    return _createClass(RealtimePresence, [{\n      key: \"onJoin\",\n      value: /** @internal */\n      function onJoin(callback) {\n        this.caller.onJoin = callback;\n      }\n      /** @internal */\n    }, {\n      key: \"onLeave\",\n      value: function onLeave(callback) {\n        this.caller.onLeave = callback;\n      }\n      /** @internal */\n    }, {\n      key: \"onSync\",\n      value: function onSync(callback) {\n        this.caller.onSync = callback;\n      }\n      /** @internal */\n    }, {\n      key: \"inPendingSyncState\",\n      value: function inPendingSyncState() {\n        return !this.joinRef || this.joinRef !== this.channel._joinRef();\n      }\n    }], [{\n      key: \"syncState\",\n      value: function syncState(currentState, newState, onJoin, onLeave) {\n        var state = this.cloneDeep(currentState);\n        var transformedState = this.transformState(newState);\n        var joins = {};\n        var leaves = {};\n        this.map(state, function (key, presences) {\n          if (!transformedState[key]) {\n            leaves[key] = presences;\n          }\n        });\n        this.map(transformedState, function (key, newPresences) {\n          var currentPresences = state[key];\n          if (currentPresences) {\n            var newPresenceRefs = newPresences.map(function (m) {\n              return m.presence_ref;\n            });\n            var curPresenceRefs = currentPresences.map(function (m) {\n              return m.presence_ref;\n            });\n            var joinedPresences = newPresences.filter(function (m) {\n              return curPresenceRefs.indexOf(m.presence_ref) < 0;\n            });\n            var leftPresences = currentPresences.filter(function (m) {\n              return newPresenceRefs.indexOf(m.presence_ref) < 0;\n            });\n            if (joinedPresences.length > 0) {\n              joins[key] = joinedPresences;\n            }\n            if (leftPresences.length > 0) {\n              leaves[key] = leftPresences;\n            }\n          } else {\n            joins[key] = newPresences;\n          }\n        });\n        return this.syncDiff(state, {\n          joins,\n          leaves\n        }, onJoin, onLeave);\n      }\n      /**\n       * Used to sync a diff of presence join and leave events from the\n       * server, as they happen.\n       *\n       * Like `syncState`, `syncDiff` accepts optional `onJoin` and\n       * `onLeave` callbacks to react to a user joining or leaving from a\n       * device.\n       *\n       * @internal\n       */\n    }, {\n      key: \"syncDiff\",\n      value: function syncDiff(state, diff, onJoin, onLeave) {\n        var _this2 = this;\n        var _joins$leaves = {\n            joins: this.transformState(diff.joins),\n            leaves: this.transformState(diff.leaves)\n          },\n          joins = _joins$leaves.joins,\n          leaves = _joins$leaves.leaves;\n        if (!onJoin) {\n          onJoin = function () {};\n        }\n        if (!onLeave) {\n          onLeave = function () {};\n        }\n        this.map(joins, function (key, newPresences) {\n          var _a;\n          var currentPresences = (_a = state[key]) !== null && _a !== void 0 ? _a : [];\n          state[key] = _this2.cloneDeep(newPresences);\n          if (currentPresences.length > 0) {\n            var joinedPresenceRefs = state[key].map(function (m) {\n              return m.presence_ref;\n            });\n            var curPresences = currentPresences.filter(function (m) {\n              return joinedPresenceRefs.indexOf(m.presence_ref) < 0;\n            });\n            state[key].unshift(...curPresences);\n          }\n          onJoin(key, currentPresences, newPresences);\n        });\n        this.map(leaves, function (key, leftPresences) {\n          var currentPresences = state[key];\n          if (!currentPresences) return;\n          var presenceRefsToRemove = leftPresences.map(function (m) {\n            return m.presence_ref;\n          });\n          currentPresences = currentPresences.filter(function (m) {\n            return presenceRefsToRemove.indexOf(m.presence_ref) < 0;\n          });\n          state[key] = currentPresences;\n          onLeave(key, currentPresences, leftPresences);\n          if (currentPresences.length === 0) delete state[key];\n        });\n        return state;\n      }\n      /** @internal */\n    }, {\n      key: \"map\",\n      value: function map(obj, func) {\n        return Object.getOwnPropertyNames(obj).map(function (key) {\n          return func(key, obj[key]);\n        });\n      }\n      /**\n       * Remove 'metas' key\n       * Change 'phx_ref' to 'presence_ref'\n       * Remove 'phx_ref' and 'phx_ref_prev'\n       *\n       * @example\n       * // returns {\n       *  abc123: [\n       *    { presence_ref: '2', user_id: 1 },\n       *    { presence_ref: '3', user_id: 2 }\n       *  ]\n       * }\n       * RealtimePresence.transformState({\n       *  abc123: {\n       *    metas: [\n       *      { phx_ref: '2', phx_ref_prev: '1' user_id: 1 },\n       *      { phx_ref: '3', user_id: 2 }\n       *    ]\n       *  }\n       * })\n       *\n       * @internal\n       */\n    }, {\n      key: \"transformState\",\n      value: function transformState(state) {\n        state = this.cloneDeep(state);\n        return Object.getOwnPropertyNames(state).reduce(function (newState, key) {\n          var presences = state[key];\n          if ('metas' in presences) {\n            newState[key] = presences.metas.map(function (presence) {\n              presence['presence_ref'] = presence['phx_ref'];\n              delete presence['phx_ref'];\n              delete presence['phx_ref_prev'];\n              return presence;\n            });\n          } else {\n            newState[key] = presences;\n          }\n          return newState;\n        }, {});\n      }\n      /** @internal */\n    }, {\n      key: \"cloneDeep\",\n      value: function cloneDeep(obj) {\n        return JSON.parse(JSON.stringify(obj));\n      }\n    }]);\n  }();\n  exports.default = RealtimePresence;\n});","lineCount":282,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0],[5,0,3,0],[6,0,4,0],[7,0,5,0],[8,2,2,0],[8,6,2,0,"_classCallCheck"],[8,21,2,0],[8,24,2,0,"_$$_REQUIRE"],[8,35,2,0],[8,36,2,0,"_dependencyMap"],[8,50,2,0],[9,2,2,0],[9,6,2,0,"_createClass"],[9,18,2,0],[9,21,2,0,"_$$_REQUIRE"],[9,32,2,0],[9,33,2,0,"_dependencyMap"],[9,47,2,0],[10,2,6,0,"Object"],[10,8,6,6],[10,9,6,7,"defineProperty"],[10,23,6,21],[10,24,6,22,"exports"],[10,31,6,29],[10,33,6,31],[10,45,6,43],[10,47,6,45],[11,4,6,47,"value"],[11,9,6,52],[11,11,6,54],[12,2,6,59],[12,3,6,60],[12,4,6,61],[13,2,7,0,"exports"],[13,9,7,7],[13,10,7,8,"REALTIME_PRESENCE_LISTEN_EVENTS"],[13,41,7,39],[13,44,7,42],[13,49,7,47],[13,50,7,48],[14,2,8,0],[14,6,8,4,"REALTIME_PRESENCE_LISTEN_EVENTS"],[14,37,8,35],[15,2,9,0],[15,3,9,1],[15,13,9,11,"REALTIME_PRESENCE_LISTEN_EVENTS"],[15,44,9,42],[15,46,9,44],[16,4,10,4,"REALTIME_PRESENCE_LISTEN_EVENTS"],[16,35,10,35],[16,36,10,36],[16,42,10,42],[16,43,10,43],[16,46,10,46],[16,52,10,52],[17,4,11,4,"REALTIME_PRESENCE_LISTEN_EVENTS"],[17,35,11,35],[17,36,11,36],[17,42,11,42],[17,43,11,43],[17,46,11,46],[17,52,11,52],[18,4,12,4,"REALTIME_PRESENCE_LISTEN_EVENTS"],[18,35,12,35],[18,36,12,36],[18,43,12,43],[18,44,12,44],[18,47,12,47],[18,54,12,54],[19,2,13,0],[19,3,13,1],[19,5,13,3,"REALTIME_PRESENCE_LISTEN_EVENTS"],[19,36,13,34],[19,39,13,37,"exports"],[19,46,13,44],[19,47,13,45,"REALTIME_PRESENCE_LISTEN_EVENTS"],[19,78,13,76],[19,83,13,81,"exports"],[19,90,13,88],[19,91,13,89,"REALTIME_PRESENCE_LISTEN_EVENTS"],[19,122,13,120],[19,125,13,123],[19,126,13,124],[19,127,13,125],[19,128,13,126],[19,129,13,127],[20,2,13,128],[20,6,14,6,"RealtimePresence"],[20,22,14,22],[21,4,15,4],[22,0,16,0],[23,0,17,0],[24,0,18,0],[25,0,19,0],[26,0,20,0],[27,0,21,0],[28,4,22,4],[28,13,22,4,"RealtimePresence"],[28,30,22,16,"channel"],[28,37,22,23],[28,39,22,25,"opts"],[28,43,22,29],[28,45,22,31],[29,6,22,31],[29,10,22,31,"_this"],[29,15,22,31],[30,6,22,31,"_classCallCheck"],[30,21,22,31],[30,28,22,31,"RealtimePresence"],[30,44,22,31],[31,6,23,8],[31,10,23,12],[31,11,23,13,"channel"],[31,18,23,20],[31,21,23,23,"channel"],[31,28,23,30],[32,6,24,8],[32,10,24,12],[32,11,24,13,"state"],[32,16,24,18],[32,19,24,21],[32,20,24,22],[32,21,24,23],[33,6,25,8],[33,10,25,12],[33,11,25,13,"pendingDiffs"],[33,23,25,25],[33,26,25,28],[33,28,25,30],[34,6,26,8],[34,10,26,12],[34,11,26,13,"joinRef"],[34,18,26,20],[34,21,26,23],[34,25,26,27],[35,6,27,8],[35,10,27,12],[35,11,27,13,"caller"],[35,17,27,19],[35,20,27,22],[36,8,28,12,"onJoin"],[36,14,28,18],[36,16,28,20],[36,25,28,20,"onJoin"],[36,26,28,20],[36,28,28,26],[36,29,28,28],[36,30,28,29],[37,8,29,12,"onLeave"],[37,15,29,19],[37,17,29,21],[37,26,29,21,"onLeave"],[37,27,29,21],[37,29,29,27],[37,30,29,29],[37,31,29,30],[38,8,30,12,"onSync"],[38,14,30,18],[38,16,30,20],[38,25,30,20,"onSync"],[38,26,30,20],[38,28,30,26],[38,29,30,28],[39,6,31,8],[39,7,31,9],[40,6,32,8],[40,10,32,14,"events"],[40,16,32,20],[40,19,32,23],[40,20,32,24,"opts"],[40,24,32,28],[40,29,32,33],[40,33,32,37],[40,37,32,41,"opts"],[40,41,32,45],[40,46,32,50],[40,51,32,55],[40,52,32,56],[40,55,32,59],[40,60,32,64],[40,61,32,65],[40,64,32,68,"opts"],[40,68,32,72],[40,69,32,73,"events"],[40,75,32,79],[40,80,32,84],[41,8,33,12,"state"],[41,13,33,17],[41,15,33,19],[41,31,33,35],[42,8,34,12,"diff"],[42,12,34,16],[42,14,34,18],[43,6,35,8],[43,7,35,9],[44,6,36,8],[44,10,36,12],[44,11,36,13,"channel"],[44,18,36,20],[44,19,36,21,"_on"],[44,22,36,24],[44,23,36,25,"events"],[44,29,36,31],[44,30,36,32,"state"],[44,35,36,37],[44,37,36,39],[44,38,36,40],[44,39,36,41],[44,41,36,43],[44,51,36,44,"newState"],[44,59,36,52],[44,61,36,57],[45,8,37,12],[45,12,37,12,"_this$caller"],[45,24,37,12],[45,27,37,48,"_this"],[45,32,37,52],[45,33,37,53,"caller"],[45,39,37,59],[46,10,37,20,"onJoin"],[46,16,37,26],[46,19,37,26,"_this$caller"],[46,31,37,26],[46,32,37,20,"onJoin"],[46,38,37,26],[47,10,37,28,"onLeave"],[47,17,37,35],[47,20,37,35,"_this$caller"],[47,32,37,35],[47,33,37,28,"onLeave"],[47,40,37,35],[48,10,37,37,"onSync"],[48,16,37,43],[48,19,37,43,"_this$caller"],[48,31,37,43],[48,32,37,37,"onSync"],[48,38,37,43],[49,8,38,12,"_this"],[49,13,38,16],[49,14,38,17,"joinRef"],[49,21,38,24],[49,24,38,27,"_this"],[49,29,38,31],[49,30,38,32,"channel"],[49,37,38,39],[49,38,38,40,"_joinRef"],[49,46,38,48],[49,47,38,49],[49,48,38,50],[50,8,39,12,"_this"],[50,13,39,16],[50,14,39,17,"state"],[50,19,39,22],[50,22,39,25,"RealtimePresence"],[50,38,39,41],[50,39,39,42,"syncState"],[50,48,39,51],[50,49,39,52,"_this"],[50,54,39,56],[50,55,39,57,"state"],[50,60,39,62],[50,62,39,64,"newState"],[50,70,39,72],[50,72,39,74,"onJoin"],[50,78,39,80],[50,80,39,82,"onLeave"],[50,87,39,89],[50,88,39,90],[51,8,40,12,"_this"],[51,13,40,16],[51,14,40,17,"pendingDiffs"],[51,26,40,29],[51,27,40,30,"forEach"],[51,34,40,37],[51,35,40,38],[51,45,40,39,"diff"],[51,49,40,43],[51,51,40,48],[52,10,41,16,"_this"],[52,15,41,20],[52,16,41,21,"state"],[52,21,41,26],[52,24,41,29,"RealtimePresence"],[52,40,41,45],[52,41,41,46,"syncDiff"],[52,49,41,54],[52,50,41,55,"_this"],[52,55,41,59],[52,56,41,60,"state"],[52,61,41,65],[52,63,41,67,"diff"],[52,67,41,71],[52,69,41,73,"onJoin"],[52,75,41,79],[52,77,41,81,"onLeave"],[52,84,41,88],[52,85,41,89],[53,8,42,12],[53,9,42,13],[53,10,42,14],[54,8,43,12,"_this"],[54,13,43,16],[54,14,43,17,"pendingDiffs"],[54,26,43,29],[54,29,43,32],[54,31,43,34],[55,8,44,12,"onSync"],[55,14,44,18],[55,15,44,19],[55,16,44,20],[56,6,45,8],[56,7,45,9],[56,8,45,10],[57,6,46,8],[57,10,46,12],[57,11,46,13,"channel"],[57,18,46,20],[57,19,46,21,"_on"],[57,22,46,24],[57,23,46,25,"events"],[57,29,46,31],[57,30,46,32,"diff"],[57,34,46,36],[57,36,46,38],[57,37,46,39],[57,38,46,40],[57,40,46,42],[57,50,46,43,"diff"],[57,54,46,47],[57,56,46,52],[58,8,47,12],[58,12,47,12,"_this$caller2"],[58,25,47,12],[58,28,47,48,"_this"],[58,33,47,52],[58,34,47,53,"caller"],[58,40,47,59],[59,10,47,20,"onJoin"],[59,16,47,26],[59,19,47,26,"_this$caller2"],[59,32,47,26],[59,33,47,20,"onJoin"],[59,39,47,26],[60,10,47,28,"onLeave"],[60,17,47,35],[60,20,47,35,"_this$caller2"],[60,33,47,35],[60,34,47,28,"onLeave"],[60,41,47,35],[61,10,47,37,"onSync"],[61,16,47,43],[61,19,47,43,"_this$caller2"],[61,32,47,43],[61,33,47,37,"onSync"],[61,39,47,43],[62,8,48,12],[62,12,48,16,"_this"],[62,17,48,20],[62,18,48,21,"inPendingSyncState"],[62,36,48,39],[62,37,48,40],[62,38,48,41],[62,40,48,43],[63,10,49,16,"_this"],[63,15,49,20],[63,16,49,21,"pendingDiffs"],[63,28,49,33],[63,29,49,34,"push"],[63,33,49,38],[63,34,49,39,"diff"],[63,38,49,43],[63,39,49,44],[64,8,50,12],[64,9,50,13],[64,15,51,17],[65,10,52,16,"_this"],[65,15,52,20],[65,16,52,21,"state"],[65,21,52,26],[65,24,52,29,"RealtimePresence"],[65,40,52,45],[65,41,52,46,"syncDiff"],[65,49,52,54],[65,50,52,55,"_this"],[65,55,52,59],[65,56,52,60,"state"],[65,61,52,65],[65,63,52,67,"diff"],[65,67,52,71],[65,69,52,73,"onJoin"],[65,75,52,79],[65,77,52,81,"onLeave"],[65,84,52,88],[65,85,52,89],[66,10,53,16,"onSync"],[66,16,53,22],[66,17,53,23],[66,18,53,24],[67,8,54,12],[68,6,55,8],[68,7,55,9],[68,8,55,10],[69,6,56,8],[69,10,56,12],[69,11,56,13,"onJoin"],[69,17,56,19],[69,18,56,20],[69,28,56,21,"key"],[69,31,56,24],[69,33,56,26,"currentPresences"],[69,49,56,42],[69,51,56,44,"newPresences"],[69,63,56,56],[69,65,56,61],[70,8,57,12,"_this"],[70,13,57,16],[70,14,57,17,"channel"],[70,21,57,24],[70,22,57,25,"_trigger"],[70,30,57,33],[70,31,57,34],[70,41,57,44],[70,43,57,46],[71,10,58,16,"event"],[71,15,58,21],[71,17,58,23],[71,23,58,29],[72,10,59,16,"key"],[72,13,59,19],[73,10,60,16,"currentPresences"],[73,26,60,32],[74,10,61,16,"newPresences"],[75,8,62,12],[75,9,62,13],[75,10,62,14],[76,6,63,8],[76,7,63,9],[76,8,63,10],[77,6,64,8],[77,10,64,12],[77,11,64,13,"onLeave"],[77,18,64,20],[77,19,64,21],[77,29,64,22,"key"],[77,32,64,25],[77,34,64,27,"currentPresences"],[77,50,64,43],[77,52,64,45,"leftPresences"],[77,65,64,58],[77,67,64,63],[78,8,65,12,"_this"],[78,13,65,16],[78,14,65,17,"channel"],[78,21,65,24],[78,22,65,25,"_trigger"],[78,30,65,33],[78,31,65,34],[78,41,65,44],[78,43,65,46],[79,10,66,16,"event"],[79,15,66,21],[79,17,66,23],[79,24,66,30],[80,10,67,16,"key"],[80,13,67,19],[81,10,68,16,"currentPresences"],[81,26,68,32],[82,10,69,16,"leftPresences"],[83,8,70,12],[83,9,70,13],[83,10,70,14],[84,6,71,8],[84,7,71,9],[84,8,71,10],[85,6,72,8],[85,10,72,12],[85,11,72,13,"onSync"],[85,17,72,19],[85,18,72,20],[85,30,72,26],[86,8,73,12,"_this"],[86,13,73,16],[86,14,73,17,"channel"],[86,21,73,24],[86,22,73,25,"_trigger"],[86,30,73,33],[86,31,73,34],[86,41,73,44],[86,43,73,46],[87,10,73,48,"event"],[87,15,73,53],[87,17,73,55],[88,8,73,62],[88,9,73,63],[88,10,73,64],[89,6,74,8],[89,7,74,9],[89,8,74,10],[90,4,75,4],[91,4,76,4],[92,0,77,0],[93,0,78,0],[94,0,79,0],[95,0,80,0],[96,0,81,0],[97,0,82,0],[98,0,83,0],[99,0,84,0],[100,0,85,0],[101,4,76,4],[101,11,76,4,"_createClass"],[101,23,76,4],[101,24,76,4,"RealtimePresence"],[101,40,76,4],[102,6,76,4,"key"],[102,9,76,4],[103,6,76,4,"value"],[103,11,76,4],[103,13,210,4],[104,6,211,4],[104,15,211,4,"onJoin"],[104,21,211,10,"onJoin"],[104,22,211,11,"callback"],[104,30,211,19],[104,32,211,21],[105,8,212,8],[105,12,212,12],[105,13,212,13,"caller"],[105,19,212,19],[105,20,212,20,"onJoin"],[105,26,212,26],[105,29,212,29,"callback"],[105,37,212,37],[106,6,213,4],[107,6,214,4],[108,4,214,4],[109,6,214,4,"key"],[109,9,214,4],[110,6,214,4,"value"],[110,11,214,4],[110,13,215,4],[110,22,215,4,"onLeave"],[110,29,215,11,"onLeave"],[110,30,215,12,"callback"],[110,38,215,20],[110,40,215,22],[111,8,216,8],[111,12,216,12],[111,13,216,13,"caller"],[111,19,216,19],[111,20,216,20,"onLeave"],[111,27,216,27],[111,30,216,30,"callback"],[111,38,216,38],[112,6,217,4],[113,6,218,4],[114,4,218,4],[115,6,218,4,"key"],[115,9,218,4],[116,6,218,4,"value"],[116,11,218,4],[116,13,219,4],[116,22,219,4,"onSync"],[116,28,219,10,"onSync"],[116,29,219,11,"callback"],[116,37,219,19],[116,39,219,21],[117,8,220,8],[117,12,220,12],[117,13,220,13,"caller"],[117,19,220,19],[117,20,220,20,"onSync"],[117,26,220,26],[117,29,220,29,"callback"],[117,37,220,37],[118,6,221,4],[119,6,222,4],[120,4,222,4],[121,6,222,4,"key"],[121,9,222,4],[122,6,222,4,"value"],[122,11,222,4],[122,13,223,4],[122,22,223,4,"inPendingSyncState"],[122,40,223,22,"inPendingSyncState"],[122,41,223,22],[122,43,223,25],[123,8,224,8],[123,15,224,15],[123,16,224,16],[123,20,224,20],[123,21,224,21,"joinRef"],[123,28,224,28],[123,32,224,32],[123,36,224,36],[123,37,224,37,"joinRef"],[123,44,224,44],[123,49,224,49],[123,53,224,53],[123,54,224,54,"channel"],[123,61,224,61],[123,62,224,62,"_joinRef"],[123,70,224,70],[123,71,224,71],[123,72,224,72],[124,6,225,4],[125,4,225,5],[126,6,225,5,"key"],[126,9,225,5],[127,6,225,5,"value"],[127,11,225,5],[127,13,86,4],[127,22,86,11,"syncState"],[127,31,86,20,"syncState"],[127,32,86,21,"currentState"],[127,44,86,33],[127,46,86,35,"newState"],[127,54,86,43],[127,56,86,45,"onJoin"],[127,62,86,51],[127,64,86,53,"onLeave"],[127,71,86,60],[127,73,86,62],[128,8,87,8],[128,12,87,14,"state"],[128,17,87,19],[128,20,87,22],[128,24,87,26],[128,25,87,27,"cloneDeep"],[128,34,87,36],[128,35,87,37,"currentState"],[128,47,87,49],[128,48,87,50],[129,8,88,8],[129,12,88,14,"transformedState"],[129,28,88,30],[129,31,88,33],[129,35,88,37],[129,36,88,38,"transformState"],[129,50,88,52],[129,51,88,53,"newState"],[129,59,88,61],[129,60,88,62],[130,8,89,8],[130,12,89,14,"joins"],[130,17,89,19],[130,20,89,22],[130,21,89,23],[130,22,89,24],[131,8,90,8],[131,12,90,14,"leaves"],[131,18,90,20],[131,21,90,23],[131,22,90,24],[131,23,90,25],[132,8,91,8],[132,12,91,12],[132,13,91,13,"map"],[132,16,91,16],[132,17,91,17,"state"],[132,22,91,22],[132,24,91,24],[132,34,91,25,"key"],[132,37,91,28],[132,39,91,30,"presences"],[132,48,91,39],[132,50,91,44],[133,10,92,12],[133,14,92,16],[133,15,92,17,"transformedState"],[133,31,92,33],[133,32,92,34,"key"],[133,35,92,37],[133,36,92,38],[133,38,92,40],[134,12,93,16,"leaves"],[134,18,93,22],[134,19,93,23,"key"],[134,22,93,26],[134,23,93,27],[134,26,93,30,"presences"],[134,35,93,39],[135,10,94,12],[136,8,95,8],[136,9,95,9],[136,10,95,10],[137,8,96,8],[137,12,96,12],[137,13,96,13,"map"],[137,16,96,16],[137,17,96,17,"transformedState"],[137,33,96,33],[137,35,96,35],[137,45,96,36,"key"],[137,48,96,39],[137,50,96,41,"newPresences"],[137,62,96,53],[137,64,96,58],[138,10,97,12],[138,14,97,18,"currentPresences"],[138,30,97,34],[138,33,97,37,"state"],[138,38,97,42],[138,39,97,43,"key"],[138,42,97,46],[138,43,97,47],[139,10,98,12],[139,14,98,16,"currentPresences"],[139,30,98,32],[139,32,98,34],[140,12,99,16],[140,16,99,22,"newPresenceRefs"],[140,31,99,37],[140,34,99,40,"newPresences"],[140,46,99,52],[140,47,99,53,"map"],[140,50,99,56],[140,51,99,57],[140,61,99,58,"m"],[140,62,99,59],[141,14,99,59],[141,21,99,64,"m"],[141,22,99,65],[141,23,99,66,"presence_ref"],[141,35,99,78],[142,12,99,78],[142,14,99,79],[143,12,100,16],[143,16,100,22,"curPresenceRefs"],[143,31,100,37],[143,34,100,40,"currentPresences"],[143,50,100,56],[143,51,100,57,"map"],[143,54,100,60],[143,55,100,61],[143,65,100,62,"m"],[143,66,100,63],[144,14,100,63],[144,21,100,68,"m"],[144,22,100,69],[144,23,100,70,"presence_ref"],[144,35,100,82],[145,12,100,82],[145,14,100,83],[146,12,101,16],[146,16,101,22,"joinedPresences"],[146,31,101,37],[146,34,101,40,"newPresences"],[146,46,101,52],[146,47,101,53,"filter"],[146,53,101,59],[146,54,101,60],[146,64,101,61,"m"],[146,65,101,62],[147,14,101,62],[147,21,101,67,"curPresenceRefs"],[147,36,101,82],[147,37,101,83,"indexOf"],[147,44,101,90],[147,45,101,91,"m"],[147,46,101,92],[147,47,101,93,"presence_ref"],[147,59,101,105],[147,60,101,106],[147,63,101,109],[147,64,101,110],[148,12,101,110],[148,14,101,111],[149,12,102,16],[149,16,102,22,"leftPresences"],[149,29,102,35],[149,32,102,38,"currentPresences"],[149,48,102,54],[149,49,102,55,"filter"],[149,55,102,61],[149,56,102,62],[149,66,102,63,"m"],[149,67,102,64],[150,14,102,64],[150,21,102,69,"newPresenceRefs"],[150,36,102,84],[150,37,102,85,"indexOf"],[150,44,102,92],[150,45,102,93,"m"],[150,46,102,94],[150,47,102,95,"presence_ref"],[150,59,102,107],[150,60,102,108],[150,63,102,111],[150,64,102,112],[151,12,102,112],[151,14,102,113],[152,12,103,16],[152,16,103,20,"joinedPresences"],[152,31,103,35],[152,32,103,36,"length"],[152,38,103,42],[152,41,103,45],[152,42,103,46],[152,44,103,48],[153,14,104,20,"joins"],[153,19,104,25],[153,20,104,26,"key"],[153,23,104,29],[153,24,104,30],[153,27,104,33,"joinedPresences"],[153,42,104,48],[154,12,105,16],[155,12,106,16],[155,16,106,20,"leftPresences"],[155,29,106,33],[155,30,106,34,"length"],[155,36,106,40],[155,39,106,43],[155,40,106,44],[155,42,106,46],[156,14,107,20,"leaves"],[156,20,107,26],[156,21,107,27,"key"],[156,24,107,30],[156,25,107,31],[156,28,107,34,"leftPresences"],[156,41,107,47],[157,12,108,16],[158,10,109,12],[158,11,109,13],[158,17,110,17],[159,12,111,16,"joins"],[159,17,111,21],[159,18,111,22,"key"],[159,21,111,25],[159,22,111,26],[159,25,111,29,"newPresences"],[159,37,111,41],[160,10,112,12],[161,8,113,8],[161,9,113,9],[161,10,113,10],[162,8,114,8],[162,15,114,15],[162,19,114,19],[162,20,114,20,"syncDiff"],[162,28,114,28],[162,29,114,29,"state"],[162,34,114,34],[162,36,114,36],[163,10,114,38,"joins"],[163,15,114,43],[164,10,114,45,"leaves"],[165,8,114,52],[165,9,114,53],[165,11,114,55,"onJoin"],[165,17,114,61],[165,19,114,63,"onLeave"],[165,26,114,70],[165,27,114,71],[166,6,115,4],[167,6,116,4],[168,0,117,0],[169,0,118,0],[170,0,119,0],[171,0,120,0],[172,0,121,0],[173,0,122,0],[174,0,123,0],[175,0,124,0],[176,0,125,0],[177,4,116,4],[178,6,116,4,"key"],[178,9,116,4],[179,6,116,4,"value"],[179,11,116,4],[179,13,126,4],[179,22,126,11,"syncDiff"],[179,30,126,19,"syncDiff"],[179,31,126,20,"state"],[179,36,126,25],[179,38,126,27,"diff"],[179,42,126,31],[179,44,126,33,"onJoin"],[179,50,126,39],[179,52,126,41,"onLeave"],[179,59,126,48],[179,61,126,50],[180,8,126,50],[180,12,126,50,"_this2"],[180,18,126,50],[181,8,127,8],[181,12,127,8,"_joins$leaves"],[181,25,127,8],[181,28,127,34],[182,12,128,12,"joins"],[182,17,128,17],[182,19,128,19],[182,23,128,23],[182,24,128,24,"transformState"],[182,38,128,38],[182,39,128,39,"diff"],[182,43,128,43],[182,44,128,44,"joins"],[182,49,128,49],[182,50,128,50],[183,12,129,12,"leaves"],[183,18,129,18],[183,20,129,20],[183,24,129,24],[183,25,129,25,"transformState"],[183,39,129,39],[183,40,129,40,"diff"],[183,44,129,44],[183,45,129,45,"leaves"],[183,51,129,51],[184,10,130,8],[184,11,130,9],[185,10,127,16,"joins"],[185,15,127,21],[185,18,127,21,"_joins$leaves"],[185,31,127,21],[185,32,127,16,"joins"],[185,37,127,21],[186,10,127,23,"leaves"],[186,16,127,29],[186,19,127,29,"_joins$leaves"],[186,32,127,29],[186,33,127,23,"leaves"],[186,39,127,29],[187,8,131,8],[187,12,131,12],[187,13,131,13,"onJoin"],[187,19,131,19],[187,21,131,21],[188,10,132,12,"onJoin"],[188,16,132,18],[188,19,132,21],[188,28,132,21,"onJoin"],[188,29,132,21],[188,31,132,27],[188,32,132,29],[188,33,132,30],[189,8,133,8],[190,8,134,8],[190,12,134,12],[190,13,134,13,"onLeave"],[190,20,134,20],[190,22,134,22],[191,10,135,12,"onLeave"],[191,17,135,19],[191,20,135,22],[191,29,135,22,"onLeave"],[191,30,135,22],[191,32,135,28],[191,33,135,30],[191,34,135,31],[192,8,136,8],[193,8,137,8],[193,12,137,12],[193,13,137,13,"map"],[193,16,137,16],[193,17,137,17,"joins"],[193,22,137,22],[193,24,137,24],[193,34,137,25,"key"],[193,37,137,28],[193,39,137,30,"newPresences"],[193,51,137,42],[193,53,137,47],[194,10,138,12],[194,14,138,16,"_a"],[194,16,138,18],[195,10,139,12],[195,14,139,18,"currentPresences"],[195,30,139,34],[195,33,139,37],[195,34,139,38,"_a"],[195,36,139,40],[195,39,139,43,"state"],[195,44,139,48],[195,45,139,49,"key"],[195,48,139,52],[195,49,139,53],[195,55,139,59],[195,59,139,63],[195,63,139,67,"_a"],[195,65,139,69],[195,70,139,74],[195,75,139,79],[195,76,139,80],[195,79,139,83,"_a"],[195,81,139,85],[195,84,139,88],[195,86,139,90],[196,10,140,12,"state"],[196,15,140,17],[196,16,140,18,"key"],[196,19,140,21],[196,20,140,22],[196,23,140,25,"_this2"],[196,29,140,29],[196,30,140,30,"cloneDeep"],[196,39,140,39],[196,40,140,40,"newPresences"],[196,52,140,52],[196,53,140,53],[197,10,141,12],[197,14,141,16,"currentPresences"],[197,30,141,32],[197,31,141,33,"length"],[197,37,141,39],[197,40,141,42],[197,41,141,43],[197,43,141,45],[198,12,142,16],[198,16,142,22,"joinedPresenceRefs"],[198,34,142,40],[198,37,142,43,"state"],[198,42,142,48],[198,43,142,49,"key"],[198,46,142,52],[198,47,142,53],[198,48,142,54,"map"],[198,51,142,57],[198,52,142,58],[198,62,142,59,"m"],[198,63,142,60],[199,14,142,60],[199,21,142,65,"m"],[199,22,142,66],[199,23,142,67,"presence_ref"],[199,35,142,79],[200,12,142,79],[200,14,142,80],[201,12,143,16],[201,16,143,22,"curPresences"],[201,28,143,34],[201,31,143,37,"currentPresences"],[201,47,143,53],[201,48,143,54,"filter"],[201,54,143,60],[201,55,143,61],[201,65,143,62,"m"],[201,66,143,63],[202,14,143,63],[202,21,143,68,"joinedPresenceRefs"],[202,39,143,86],[202,40,143,87,"indexOf"],[202,47,143,94],[202,48,143,95,"m"],[202,49,143,96],[202,50,143,97,"presence_ref"],[202,62,143,109],[202,63,143,110],[202,66,143,113],[202,67,143,114],[203,12,143,114],[203,14,143,115],[204,12,144,16,"state"],[204,17,144,21],[204,18,144,22,"key"],[204,21,144,25],[204,22,144,26],[204,23,144,27,"unshift"],[204,30,144,34],[204,31,144,35],[204,34,144,38,"curPresences"],[204,46,144,50],[204,47,144,51],[205,10,145,12],[206,10,146,12,"onJoin"],[206,16,146,18],[206,17,146,19,"key"],[206,20,146,22],[206,22,146,24,"currentPresences"],[206,38,146,40],[206,40,146,42,"newPresences"],[206,52,146,54],[206,53,146,55],[207,8,147,8],[207,9,147,9],[207,10,147,10],[208,8,148,8],[208,12,148,12],[208,13,148,13,"map"],[208,16,148,16],[208,17,148,17,"leaves"],[208,23,148,23],[208,25,148,25],[208,35,148,26,"key"],[208,38,148,29],[208,40,148,31,"leftPresences"],[208,53,148,44],[208,55,148,49],[209,10,149,12],[209,14,149,16,"currentPresences"],[209,30,149,32],[209,33,149,35,"state"],[209,38,149,40],[209,39,149,41,"key"],[209,42,149,44],[209,43,149,45],[210,10,150,12],[210,14,150,16],[210,15,150,17,"currentPresences"],[210,31,150,33],[210,33,151,16],[211,10,152,12],[211,14,152,18,"presenceRefsToRemove"],[211,34,152,38],[211,37,152,41,"leftPresences"],[211,50,152,54],[211,51,152,55,"map"],[211,54,152,58],[211,55,152,59],[211,65,152,60,"m"],[211,66,152,61],[212,12,152,61],[212,19,152,66,"m"],[212,20,152,67],[212,21,152,68,"presence_ref"],[212,33,152,80],[213,10,152,80],[213,12,152,81],[214,10,153,12,"currentPresences"],[214,26,153,28],[214,29,153,31,"currentPresences"],[214,45,153,47],[214,46,153,48,"filter"],[214,52,153,54],[214,53,153,55],[214,63,153,56,"m"],[214,64,153,57],[215,12,153,57],[215,19,153,62,"presenceRefsToRemove"],[215,39,153,82],[215,40,153,83,"indexOf"],[215,47,153,90],[215,48,153,91,"m"],[215,49,153,92],[215,50,153,93,"presence_ref"],[215,62,153,105],[215,63,153,106],[215,66,153,109],[215,67,153,110],[216,10,153,110],[216,12,153,111],[217,10,154,12,"state"],[217,15,154,17],[217,16,154,18,"key"],[217,19,154,21],[217,20,154,22],[217,23,154,25,"currentPresences"],[217,39,154,41],[218,10,155,12,"onLeave"],[218,17,155,19],[218,18,155,20,"key"],[218,21,155,23],[218,23,155,25,"currentPresences"],[218,39,155,41],[218,41,155,43,"leftPresences"],[218,54,155,56],[218,55,155,57],[219,10,156,12],[219,14,156,16,"currentPresences"],[219,30,156,32],[219,31,156,33,"length"],[219,37,156,39],[219,42,156,44],[219,43,156,45],[219,45,157,16],[219,52,157,23,"state"],[219,57,157,28],[219,58,157,29,"key"],[219,61,157,32],[219,62,157,33],[220,8,158,8],[220,9,158,9],[220,10,158,10],[221,8,159,8],[221,15,159,15,"state"],[221,20,159,20],[222,6,160,4],[223,6,161,4],[224,4,161,4],[225,6,161,4,"key"],[225,9,161,4],[226,6,161,4,"value"],[226,11,161,4],[226,13,162,4],[226,22,162,11,"map"],[226,25,162,14,"map"],[226,26,162,15,"obj"],[226,29,162,18],[226,31,162,20,"func"],[226,35,162,24],[226,37,162,26],[227,8,163,8],[227,15,163,15,"Object"],[227,21,163,21],[227,22,163,22,"getOwnPropertyNames"],[227,41,163,41],[227,42,163,42,"obj"],[227,45,163,45],[227,46,163,46],[227,47,163,47,"map"],[227,50,163,50],[227,51,163,51],[227,61,163,52,"key"],[227,64,163,55],[228,10,163,55],[228,17,163,60,"func"],[228,21,163,64],[228,22,163,65,"key"],[228,25,163,68],[228,27,163,70,"obj"],[228,30,163,73],[228,31,163,74,"key"],[228,34,163,77],[228,35,163,78],[228,36,163,79],[229,8,163,79],[229,10,163,80],[230,6,164,4],[231,6,165,4],[232,0,166,0],[233,0,167,0],[234,0,168,0],[235,0,169,0],[236,0,170,0],[237,0,171,0],[238,0,172,0],[239,0,173,0],[240,0,174,0],[241,0,175,0],[242,0,176,0],[243,0,177,0],[244,0,178,0],[245,0,179,0],[246,0,180,0],[247,0,181,0],[248,0,182,0],[249,0,183,0],[250,0,184,0],[251,0,185,0],[252,0,186,0],[253,0,187,0],[254,4,165,4],[255,6,165,4,"key"],[255,9,165,4],[256,6,165,4,"value"],[256,11,165,4],[256,13,188,4],[256,22,188,11,"transformState"],[256,36,188,25,"transformState"],[256,37,188,26,"state"],[256,42,188,31],[256,44,188,33],[257,8,189,8,"state"],[257,13,189,13],[257,16,189,16],[257,20,189,20],[257,21,189,21,"cloneDeep"],[257,30,189,30],[257,31,189,31,"state"],[257,36,189,36],[257,37,189,37],[258,8,190,8],[258,15,190,15,"Object"],[258,21,190,21],[258,22,190,22,"getOwnPropertyNames"],[258,41,190,41],[258,42,190,42,"state"],[258,47,190,47],[258,48,190,48],[258,49,190,49,"reduce"],[258,55,190,55],[258,56,190,56],[258,66,190,57,"newState"],[258,74,190,65],[258,76,190,67,"key"],[258,79,190,70],[258,81,190,75],[259,10,191,12],[259,14,191,18,"presences"],[259,23,191,27],[259,26,191,30,"state"],[259,31,191,35],[259,32,191,36,"key"],[259,35,191,39],[259,36,191,40],[260,10,192,12],[260,14,192,16],[260,21,192,23],[260,25,192,27,"presences"],[260,34,192,36],[260,36,192,38],[261,12,193,16,"newState"],[261,20,193,24],[261,21,193,25,"key"],[261,24,193,28],[261,25,193,29],[261,28,193,32,"presences"],[261,37,193,41],[261,38,193,42,"metas"],[261,43,193,47],[261,44,193,48,"map"],[261,47,193,51],[261,48,193,52],[261,58,193,53,"presence"],[261,66,193,61],[261,68,193,66],[262,14,194,20,"presence"],[262,22,194,28],[262,23,194,29],[262,37,194,43],[262,38,194,44],[262,41,194,47,"presence"],[262,49,194,55],[262,50,194,56],[262,59,194,65],[262,60,194,66],[263,14,195,20],[263,21,195,27,"presence"],[263,29,195,35],[263,30,195,36],[263,39,195,45],[263,40,195,46],[264,14,196,20],[264,21,196,27,"presence"],[264,29,196,35],[264,30,196,36],[264,44,196,50],[264,45,196,51],[265,14,197,20],[265,21,197,27,"presence"],[265,29,197,35],[266,12,198,16],[266,13,198,17],[266,14,198,18],[267,10,199,12],[267,11,199,13],[267,17,200,17],[268,12,201,16,"newState"],[268,20,201,24],[268,21,201,25,"key"],[268,24,201,28],[268,25,201,29],[268,28,201,32,"presences"],[268,37,201,41],[269,10,202,12],[270,10,203,12],[270,17,203,19,"newState"],[270,25,203,27],[271,8,204,8],[271,9,204,9],[271,11,204,11],[271,12,204,12],[271,13,204,13],[271,14,204,14],[272,6,205,4],[273,6,206,4],[274,4,206,4],[275,6,206,4,"key"],[275,9,206,4],[276,6,206,4,"value"],[276,11,206,4],[276,13,207,4],[276,22,207,11,"cloneDeep"],[276,31,207,20,"cloneDeep"],[276,32,207,21,"obj"],[276,35,207,24],[276,37,207,26],[277,8,208,8],[277,15,208,15,"JSON"],[277,19,208,19],[277,20,208,20,"parse"],[277,25,208,25],[277,26,208,26,"JSON"],[277,30,208,30],[277,31,208,31,"stringify"],[277,40,208,40],[277,41,208,41,"obj"],[277,44,208,44],[277,45,208,45],[277,46,208,46],[278,6,209,4],[279,4,209,5],[280,2,209,5],[281,2,227,0,"exports"],[281,9,227,7],[281,10,227,8,"default"],[281,17,227,15],[281,20,227,18,"RealtimePresence"],[281,36,227,34],[282,0,227,35]],"functionMap":{"names":["<global>","<anonymous>","RealtimePresence","constructor","caller.onJoin","caller.onLeave","caller.onSync","channel._on$argument_2","pendingDiffs.forEach$argument_0","onJoin$argument_0","onLeave$argument_0","onSync$argument_0","syncState","map$argument_1","newPresences.map$argument_0","currentPresences.map$argument_0","newPresences.filter$argument_0","currentPresences.filter$argument_0","syncDiff","onJoin","onLeave","state.key.map$argument_0","leftPresences.map$argument_0","map","Object.getOwnPropertyNames.map$argument_0","transformState","Object.getOwnPropertyNames.reduce$argument_0","presences.metas.map$argument_0","cloneDeep","onSync","inPendingSyncState"],"mappings":"AAA;CCQ;CDI;AEC;ICQ;oBCM,SD;qBEC,SF;oBGC,SH;2CIM;sCCI;aDE;SJG;0CIC;SJS;oBMC;SNO;qBOC;SPO;oBQC;SRE;KDC;IUW;wBCK;SDI;mCCC;yDCG,qBD;6DEC,qBF;4DGC,kDH;8DIC,kDJ;SDW;KVE;IgBW;qBCM,SD;sBEG,SF;wBLE;0DQK,qBR;6DIC,qDJ;SKI;yBLC;2DSI,qBT;uDIC,uDJ;SKK;KhBE;IqBE;mDCC,4BD;KrBC;IuBwB;wDCE;oDCG;iBDK;SDM;KvBC;I0BE;K1BE;IiBE;KjBE;IkBE;KlBE;I2BE;K3BE;I4BE;K5BE;CFC"}},"type":"js/module"}]}